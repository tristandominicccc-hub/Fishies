local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Create main screen GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MobileGUI_Animated"
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false
if gethui then
    ScreenGui.Parent = gethui()
else
    ScreenGui.Parent = PlayerGui
end

-- === MAIN GUI SECTION ===
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 380, 0, 280)
MainFrame.Position = UDim2.new(0.5, -190, 0.5, -140)
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Visible = true
MainFrame.Parent = ScreenGui

-- Corner
local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 6)
Corner.Parent = MainFrame

-- Stroke
local Stroke = Instance.new("UIStroke")
Stroke.Color = Color3.fromRGB(80, 80, 80)
Stroke.Thickness = 2
Stroke.Parent = MainFrame

-- Title bar (HORIZONTAL)
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 35)
TitleBar.Position = UDim2.new(0, 0, 0, 0)
TitleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 6)
TitleCorner.Parent = TitleBar

-- Title text
local TitleText = Instance.new("TextLabel")
TitleText.Name = "TitleText"
TitleText.Size = UDim2.new(0, 150, 1, 0)
TitleText.Position = UDim2.new(0, 10, 0, 0)
TitleText.BackgroundTransparency = 1
TitleText.Text = "duminik.gg"
TitleText.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleText.TextXAlignment = Enum.TextXAlignment.Left
TitleText.Font = Enum.Font.GothamBold
TitleText.TextSize = 14
TitleText.Parent = TitleBar

-- Minimize button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
MinimizeButton.Position = UDim2.new(1, -55, 0.5, -12.5)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
MinimizeButton.BorderSizePixel = 0
MinimizeButton.Text = "‚Äì"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 16
MinimizeButton.Parent = TitleBar

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 4)
MinCorner.Parent = MinimizeButton

-- Exit button
local ExitButton = Instance.new("TextButton")
ExitButton.Name = "ExitButton"
ExitButton.Size = UDim2.new(0, 25, 0, 25)
ExitButton.Position = UDim2.new(1, -25, 0.5, -12.5)
ExitButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
ExitButton.BorderSizePixel = 0
ExitButton.Text = "X"
ExitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ExitButton.Font = Enum.Font.GothamBold
ExitButton.TextSize = 12
ExitButton.Parent = TitleBar

local ExitCorner = Instance.new("UICorner")
ExitCorner.CornerRadius = UDim.new(0, 4)
ExitCorner.Parent = ExitButton

-- Top Tabs for Horizontal Layout
local TopTabContainer = Instance.new("Frame")
TopTabContainer.Name = "TopTabContainer"
TopTabContainer.Size = UDim2.new(1, 0, 0, 40)
TopTabContainer.Position = UDim2.new(0, 0, 0, 35)
TopTabContainer.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
TopTabContainer.BorderSizePixel = 0
TopTabContainer.Parent = MainFrame

-- Content area (HORIZONTAL)
local ContentArea = Instance.new("Frame")
ContentArea.Name = "ContentArea"
ContentArea.Size = UDim2.new(1, 0, 1, -75)
ContentArea.Position = UDim2.new(0, 0, 0, 75)
ContentArea.BackgroundTransparency = 1
ContentArea.Parent = MainFrame

-- Tab buttons
local tabs = {
    {name = "BAITS", key = "Shop"},
    {name = "GEAR", key = "Gear"},
    {name = "EGGS", key = "Egg"},
    {name = "MERCHANT", key = "Merchant"},
    {name = "EVENT", key = "Event"},
    {name = "MISC", key = "Misc"}
}

local tabButtons = {}

for i, tab in pairs(tabs) do
    local tabButton = Instance.new("TextButton")
    tabButton.Name = tab.key .. "Tab"
    tabButton.Size = UDim2.new(1 / #tabs, 0, 1, 0)
    tabButton.Position = UDim2.new((i-1) / #tabs, 0, 0, 0)
    tabButton.BackgroundColor3 = i == 1 and Color3.fromRGB(60, 60, 60) or Color3.fromRGB(35, 35, 35)
    tabButton.BorderSizePixel = 0
    tabButton.Text = tab.name
    tabButton.TextColor3 = i == 1 and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(200, 200, 200)
    tabButton.Font = i == 1 and Enum.Font.GothamBold or Enum.Font.Gotham
    tabButton.TextSize = 9
    tabButton.Parent = TopTabContainer
    
    tabButtons[tab.key] = tabButton
end

-- Content frames
local ShopContent = Instance.new("Frame")
ShopContent.Name = "ShopContent"
ShopContent.Size = UDim2.new(1, 0, 1, 0)
ShopContent.BackgroundTransparency = 1
ShopContent.Visible = true
ShopContent.Parent = ContentArea

local GearContent = Instance.new("Frame")
GearContent.Name = "GearContent"
GearContent.Size = UDim2.new(1, 0, 1, 0)
GearContent.BackgroundTransparency = 1
GearContent.Visible = false
GearContent.Parent = ContentArea

local EggContent = Instance.new("Frame")
EggContent.Name = "EggContent"
EggContent.Size = UDim2.new(1, 0, 1, 0)
EggContent.BackgroundTransparency = 1
EggContent.Visible = false
EggContent.Parent = ContentArea

local MerchantContent = Instance.new("Frame")
MerchantContent.Name = "MerchantContent"
MerchantContent.Size = UDim2.new(1, 0, 1, 0)
MerchantContent.BackgroundTransparency = 1
MerchantContent.Visible = false
MerchantContent.Parent = ContentArea

local EventContent = Instance.new("Frame")
EventContent.Name = "EventContent"
EventContent.Size = UDim2.new(1, 0, 1, 0)
EventContent.BackgroundTransparency = 1
EventContent.Visible = false
EventContent.Parent = ContentArea

local MiscContent = Instance.new("Frame")
MiscContent.Name = "MiscContent"
MiscContent.Size = UDim2.new(1, 0, 1, 0)
MiscContent.BackgroundTransparency = 1
MiscContent.Visible = false
MiscContent.Parent = ContentArea

-- Scrolling frames
local function createScrollFrame(parent)
    local scroll = Instance.new("ScrollingFrame")
    scroll.Size = UDim2.new(1, -5, 1, -5)
    scroll.Position = UDim2.new(0, 2, 0, 2)
    scroll.BackgroundTransparency = 1
    scroll.BorderSizePixel = 0
    scroll.ScrollBarThickness = 3
    scroll.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
    scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    scroll.Parent = parent
    
    local layout = Instance.new("UIListLayout")
    layout.Padding = UDim.new(0, 5)
    layout.Parent = scroll
    
    return scroll, layout
end

local ShopScroll, ShopListLayout = createScrollFrame(ShopContent)
local GearScroll, GearListLayout = createScrollFrame(GearContent)
local EggScroll, EggListLayout = createScrollFrame(EggContent)
local MerchantScroll, MerchantListLayout = createScrollFrame(MerchantContent)
local EventScroll, EventListLayout = createScrollFrame(EventContent)
local MiscScroll, MiscListLayout = createScrollFrame(MiscContent)

-- === UNIVERSAL CLIPBOARD FUNCTION (FIXED) ===
local function copyToClipboard(text)
    local success, err = pcall(function()
        if setclipboard then
            setclipboard(text)
            return true
        elseif toclipboard then
            toclipboard(text)
            return true
        elseif setrbxclipboard then
            setrbxclipboard(text)
            return true
        elseif writeclipboard then
            writeclipboard(text)
            return true
        elseif Synapse and Synapse.setclipboard then
            Synapse.setclipboard(text)
            return true
        end
        return false
    end)
    
    if success then return true else warn("Clipboard error: " .. tostring(err)) return false end
end

-- Mobile drag functionality
local dragging = false
local dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    local target = MainFrame
    target.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

local function startDragging(input, frame)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end

TitleBar.InputBegan:Connect(function(input) startDragging(input, MainFrame) end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then update(input) end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

-- Other GUI Logic (Tabs, Buying, etc) remains mostly the same but cleaned up
local isMinimized = false
local originalSize = MainFrame.Size

MinimizeButton.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    if isMinimized then
        MainFrame.Size = UDim2.new(0, 380, 0, 35)
        TopTabContainer.Visible = false
        ContentArea.Visible = false
    else
        MainFrame.Size = UDim2.new(0, 380, 0, 280)
        TopTabContainer.Visible = true
        ContentArea.Visible = true
    end
end)

ExitButton.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

-- Tab switching function
local function switchToTab(tabName)
    for _, v in pairs({ShopContent, GearContent, EggContent, MerchantContent, EventContent, MiscContent}) do
        v.Visible = false
    end
    
    for _, tabButton in pairs(tabButtons) do
        tabButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        tabButton.TextColor3 = Color3.fromRGB(200, 200, 200)
        tabButton.Font = Enum.Font.Gotham
    end
    
    if tabButtons[tabName] then
        tabButtons[tabName].BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        tabButtons[tabName].TextColor3 = Color3.fromRGB(255, 255, 255)
        tabButtons[tabName].Font = Enum.Font.GothamBold
    end

    if tabName == "Shop" then ShopContent.Visible = true
    elseif tabName == "Gear" then GearContent.Visible = true
    elseif tabName == "Egg" then EggContent.Visible = true
    elseif tabName == "Merchant" then MerchantContent.Visible = true
    elseif tabName == "Event" then EventContent.Visible = true
    elseif tabName == "Misc" then MiscContent.Visible = true
    end
end

-- Connect tab buttons
for key, btn in pairs(tabButtons) do
    btn.MouseButton1Click:Connect(function() switchToTab(key) end)
end

-- Active items tracker
local activeItems = {}

local function createToggle(realName, displayName, description, parent, purchaseType, isMerchant)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Size = UDim2.new(1, 0, 0, 40)
    ToggleFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = parent
    
    local ToggleCorner = Instance.new("UICorner")
    ToggleCorner.CornerRadius = UDim.new(0, 4)
    ToggleCorner.Parent = ToggleFrame
    
    local ToggleLabel = Instance.new("TextLabel")
    ToggleLabel.Size = UDim2.new(0.65, -8, 0.6, 0)
    ToggleLabel.Position = UDim2.new(0, 6, 0, 2)
    ToggleLabel.BackgroundTransparency = 1
    ToggleLabel.Text = displayName
    ToggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
    ToggleLabel.Font = Enum.Font.GothamBold
    ToggleLabel.TextSize = 11
    ToggleLabel.Parent = ToggleFrame
    
    local ToggleButton = Instance.new("TextButton")
    ToggleButton.Size = UDim2.new(0, 50, 0, 22)
    ToggleButton.Position = UDim2.new(1, -55, 0.5, -11)
    ToggleButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    ToggleButton.BorderSizePixel = 0
    ToggleButton.Text = "OFF"
    ToggleButton.TextColor3 = Color3.fromRGB(255, 100, 100)
    ToggleButton.Font = Enum.Font.GothamBold
    ToggleButton.TextSize = 9
    ToggleButton.Parent = ToggleFrame
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 4)
    ButtonCorner.Parent = ToggleButton
    
    local isToggled = false
    
    ToggleButton.MouseButton1Click:Connect(function()
        isToggled = not isToggled
        if isToggled then
            TweenService:Create(ToggleButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 180, 80)}):Play()
            ToggleButton.Text = "ON"
            ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            
            activeItems[realName] = {
                realName = realName,
                lastPurchase = 0
            }
            
            task.spawn(function()
                while activeItems[realName] do
                    local currentTime = tick()
                    if currentTime - activeItems[realName].lastPurchase >= 1 then
                        local remotePath = game:GetService("ReplicatedStorage"):WaitForChild("rbxts_include"):WaitForChild("node_modules"):WaitForChild("@rbxts"):WaitForChild("remo"):WaitForChild("src"):WaitForChild("container")
                        
                        if isMerchant then
                            remotePath:WaitForChild("merchant.purchaseItem"):FireServer("travelling", realName)
                        else
                            if purchaseType == "gear" then
                                remotePath:WaitForChild("shop.purchaseGear"):FireServer(realName)
                            elseif purchaseType == "egg" then
                                remotePath:WaitForChild("shop.purchaseEgg"):FireServer(realName)
                            else
                                remotePath:WaitForChild("shop.purchaseBait"):FireServer(realName)
                            end
                        end
                        activeItems[realName].lastPurchase = currentTime
                    end
                    task.wait(0.1)
                end
            end)
        else
            TweenService:Create(ToggleButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 80)}):Play()
            ToggleButton.Text = "OFF"
            ToggleButton.TextColor3 = Color3.fromRGB(255, 100, 100)
            activeItems[realName] = nil
        end
    end)
end

-- Populate Lists (Shortened for brevity, your original lists were fine)
local baits = {
    {real = "Starter", display = "Starter"}, {real = "Novice", display = "Novice"}, {real = "Reef", display = "Reef"},
    {real = "DeepSea", display = "Deep Sea"}, {real = "Koi", display = "Koi"}, {real = "River", display = "River"},
    {real = "Puffer", display = "Puffer"}, {real = "Glo", display = "Glo"}, {real = "Seal", display = "Seal"},
    {real = "Ray", display = "Ray"}, {real = "Octopus", display = "Octopus"}, {real = "Axolotl", display = "Axolotl"},
    {real = "Jelly", display = "Jelly"}, {real = "Whale", display = "Whale"}, {real = "Shark", display = "Shark"},
    {real = "Squid", display = "Squid"}, {real = "Megalodon", display = "Megalodon"}, {real = "Kraken", display = "Kraken"}
}
for _, b in pairs(baits) do createToggle(b.real, b.display, "", ShopScroll, "bait", false) end

local gears = {
    {real = "BasicAutoFeeder", display = "Basic Auto Feeder"}, {real = "FoodScoop", display = "Food Scoop"},
    {real = "BasicFoodTray", display = "Basic Food Tray"}, {real = "NetMover", display = "Net Mover"},
    {real = "MagnifyingGlass", display = "Magnifying Glass"}, {real = "AdvancedFoodTray", display = "Advanced Food Tray"},
    {real = "AdvancedAutoFeeder", display = "Advanced Auto Feeder"}, {real = "XpCookie", display = "XP Cookie"},
    {real = "TeleportWand", display = "Teleport Wand"}, {real = "StarLock", display = "Star Lock"},
    {real = "SupremeAutoFeeder", display = "Supreme Auto Feeder"}, {real = "PetToy", display = "Pet Toy"},
    {real = "EggHatcher", display = "Egg Hatcher"}, {real = "GoldenCookie", display = "Golden Cookie"},
    {real = "EggIncubator", display = "Egg Incubator"}, {real = "ExtremeAutoFeeder", display = "Extreme Auto Feeder"}
}
for _, g in pairs(gears) do createToggle(g.real, g.display, "", GearScroll, "gear", false) end

local eggs = {
    {real = "Starter", display = "Starter"}, {real = "Novice", display = "Novice"}, {real = "Forest", display = "Forest"},
    {real = "Polar", display = "Polar"}, {real = "Tropical", display = "Tropical"}, {real = "Exotic", display = "Exotic"}
}
for _, e in pairs(eggs) do createToggle(e.real, e.display, "", EggScroll, "egg", false) end

local merchantItems = {
    {real = "Zoo", display = "Zoo"}, {real = "Wild", display = "Wild"}, {real = "Punk", display = "Punk"},
    {real = "Boba", display = "Boba"}, {real = "Ashen", display = "Ashen"}
}
for _, m in pairs(merchantItems) do createToggle(m.real, m.display, "", MerchantScroll, "merchant", true) end

-- === EVENT TAB CONTENT ===
-- Clear the EventScroll first and remove UIListLayout
EventScroll:ClearAllChildren()

-- Event Container
local eventContainer = Instance.new("Frame")
eventContainer.Size = UDim2.new(1, -10, 1, -10)
eventContainer.Position = UDim2.new(0, 5, 0, 5)
eventContainer.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
eventContainer.Parent = EventScroll

local eventCorner = Instance.new("UICorner")
eventCorner.CornerRadius = UDim.new(0, 8)
eventCorner.Parent = eventContainer

-- Message Label
local eventMessage = Instance.new("TextLabel")
eventMessage.Size = UDim2.new(0.8, 0, 0, 80)
eventMessage.Position = UDim2.new(0.1, 0, 0.5, 0)
eventMessage.BackgroundTransparency = 1
eventMessage.Text = "COMING SOON, THE OWNER OF THIS SCRIPT IS LAZY ASS HELL üôèüíÄ"
eventMessage.TextColor3 = Color3.fromRGB(255, 100, 100)
eventMessage.Font = Enum.Font.GothamBold
eventMessage.TextSize = 12
eventMessage.TextWrapped = true
eventMessage.TextYAlignment = Enum.TextYAlignment.Top
eventMessage.Parent = eventContainer

-- === MISC TAB CONTENT ===
-- Clear the MiscScroll first
MiscScroll:ClearAllChildren()

-- Auto Sell All Fish Button
local sellBtn = Instance.new("TextButton")
sellBtn.Size = UDim2.new(1, -10, 0, 35)
sellBtn.Position = UDim2.new(0, 5, 0, 5)
sellBtn.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
sellBtn.Text = "Auto Sell All Fish"
sellBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
sellBtn.Font = Enum.Font.GothamBold
sellBtn.TextSize = 11
sellBtn.Parent = MiscScroll

local sellCorner = Instance.new("UICorner")
sellCorner.CornerRadius = UDim.new(0, 6)
sellCorner.Parent = sellBtn

sellBtn.MouseButton1Click:Connect(function()
    pcall(function()
        game:GetService("ReplicatedStorage")
            :WaitForChild("rbxts_include")
            :WaitForChild("node_modules")
            :WaitForChild("@rbxts")
            :WaitForChild("remo")
            :WaitForChild("src")
            :WaitForChild("container")
            :WaitForChild("sellFish.sellAllFish")
            :FireServer()
    end)
end)

-- Canvas Sizing
local function autoSize(layout, scroll)
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        scroll.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 10)
    end)
end
autoSize(ShopListLayout, ShopScroll)
autoSize(GearListLayout, GearScroll)
autoSize(EggListLayout, EggScroll)
autoSize(MerchantListLayout, MerchantScroll)

-- For Event and Misc tabs, set fixed canvas size since we're not using UIListLayout
EventScroll.CanvasSize = UDim2.new(0, 0, 1, 0)
MiscScroll.CanvasSize = UDim2.new(0, 0, 0, 120) -- Enough space for all MISC elements
